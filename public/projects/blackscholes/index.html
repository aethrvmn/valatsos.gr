<!DOCTYPE html>
<html lang="en"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #1b9470;
        }
    </style>

    
    
    
    
    
    

    
    <title>Black-Schols</title>
    <meta name="description" content="Database Management &amp;&amp; Machine Learning">
    <meta name="keywords" content=''>

    <meta property="og:url" content="http://localhost:1313/projects/blackscholes/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Black-Schols">
    <meta property="og:description" content="Database Management &amp;&amp; Machine Learning">
    <meta property="og:image" content="http://localhost:1313/images/logo.png">
    <meta property="og:image:secure_url" content="http://localhost:1313/images/logo.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Black-Schols">
    <meta name="twitter:description" content="Database Management &amp;&amp; Machine Learning">
    <meta property="twitter:domain" content="http://localhost:1313/projects/blackscholes/">
    <meta property="twitter:url" content="http://localhost:1313/projects/blackscholes/">
    <meta name="twitter:image" content="http://localhost:1313/images/logo.png">

    
    <link rel="canonical" href="http://localhost:1313/projects/blackscholes/" />

    
    <link rel="stylesheet" type="text/css" href="/css/normalize.min.css" media="print">

    
    <link rel="stylesheet" type="text/css" href="/css/main.min.css">

    
    <link id="dark-theme" rel="stylesheet" href="/css/dark.min.css">

    
    <script src="/js/bundle.min.224c8e70fed292d18d7d9ae1b36797c99144e0be1117e2ea2c428379c8496551.js" integrity="sha256-IkyOcP7SktGNfZrhs2eXyZFE4L4RF&#43;LqLEKDechJZVE="></script>

    
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="http://localhost:1313/">
                <img src='/images/logo.png' alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="http://localhost:1313/">Vasilis Valatsos</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="http://localhost:1313/projects/"><span data-feather='code'></span> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="http://localhost:1313/greek-rss/"><span data-feather='book-open'></span> Greek RSS </a>
            </div>
            
            <div class="nav-link">
                <a href="http://localhost:1313/about/"><span data-feather='hash'></span> About Me </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/baledick"target="_blank"><span data-feather='github' />  </a>
            </div>
            
            <div class="nav-link">
                <a href="http://localhost:1313/index.xml"><span data-feather='rss' />  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <span id="dark-theme-toggle-screen-reader-target" class="sr-only"></span>
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <span id="hamburger-menu-toggle-screen-reader-target" class="sr-only">menu</span>
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="http://localhost:1313/projects/"><span data-feather='code'></span> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="http://localhost:1313/greek-rss/"><span data-feather='book-open'></span> Greek RSS </a>
                </li>
                
                <li class="nav-item">
                    <a href="http://localhost:1313/about/"><span data-feather='hash'></span> About Me </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/baledick"target="_blank"><span data-feather='github' />  </a>
                </li>
                
                <li class="nav-item">
                    <a href="http://localhost:1313/index.xml"><span data-feather='rss' />  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <span id="dark-theme-toggle-screen-reader-target" class="sr-only">theme</span>
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>Black-Schols</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">January 1, 0001
        
        </p>

        <ul class="post-tags">
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>You can find the repository <a href="https://github.com/baledick/Black-Scholes-Model">here</a></p>
<h1 id="black-scholes-model">Black Scholes Model</h1>
<p><strong>Amandeep Singh, Vasilis Valatsos</strong></p>
<p>We attempt to make a program that predicts optional premiums, using the Black-Scholes model, introduced in 1973.</p>
<p>To start off, we first install all the required modules, (We have the cell commented, but in the case that one or more modules aren&rsquo;t installed, uncomment and run once the cell below.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># pip install -r &#34;requirements.txt&#34;</span>
</span></span></code></pre></div><p>where the module scipy.stats is not imported here but is needed in the class that we import.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BlackScholes <span style="color:#f92672">import</span> Model
</span></span></code></pre></div><h3 id="section-1">Section 1</h3>
<h4 id="testing">Testing</h4>
<p>To check whether the class functions work, as well as to explain the process, we can create a Brownian motion to simulate a possilbe stock price over four years (1460 days) and calculate all the needed variables.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">brownian</span>(time_range, mean<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, sd<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    time <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,time_range)
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros(time_range)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, time_range):
</span></span><span style="display:flex;"><span>        path[i] <span style="color:#f92672">=</span> path[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>normal(mean<span style="color:#f92672">*</span>time[i], sd<span style="color:#f92672">*</span>time[i])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> time, path
</span></span></code></pre></div><p>where time has a range from 0 to 1, because we can always scale the dates of the hypothetical stock to fit those values with an appropriate transformation. Below we see the graph of the motion</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>time_range <span style="color:#f92672">=</span> <span style="color:#ae81ff">1460</span> <span style="color:#75715e">#in days</span>
</span></span><span style="display:flex;"><span>walk <span style="color:#f92672">=</span> brownian(time_range)
</span></span><span style="display:flex;"><span>time <span style="color:#f92672">=</span> walk[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>stock_price <span style="color:#f92672">=</span> walk[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>abs(min(walk[<span style="color:#ae81ff">1</span>])) <span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(time, stock_price)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Next, we define the exercise price, where here we choose a &ldquo;smooth&rdquo; deviation from the original stock price, essentially taking a stable function and adding noise, defined by a uniform distribution over an arbitrary, probably non-realistic range. Likewise, the interest rate should float between 0% and 1%, and finally the range of the time to expiration was made 1, 2, 3, 4, and 5 months.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>variance<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0.005</span>, <span style="color:#ae81ff">0.01</span>)
</span></span><span style="display:flex;"><span>exercise_price <span style="color:#f92672">=</span> stock_price <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.1</span><span style="color:#f92672">*</span>stock_price
</span></span><span style="display:flex;"><span>interest <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0.005</span>,<span style="color:#ae81ff">0.01</span>, time_range)
</span></span><span style="display:flex;"><span>expiration_date <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e">#days</span>
</span></span><span style="display:flex;"><span>volatility <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.23</span>
</span></span></code></pre></div><p>Finally, we can initialize the Model class, using the above as inputs and executing the call and put functions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>option <span style="color:#f92672">=</span> Model(stock_price, exercise_price, interest, expiration_date, volatility)
</span></span><span style="display:flex;"><span>option<span style="color:#f92672">.</span>call()
</span></span><span style="display:flex;"><span>option<span style="color:#f92672">.</span>put()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(stock_price)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(option<span style="color:#f92672">.</span>callval)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(option<span style="color:#f92672">.</span>putval)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#39;Stock Price&#39;</span>, <span style="color:#e6db74">&#39; Call Price&#39;</span>, <span style="color:#e6db74">&#39;Put Price&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;example.png&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Since we see that the behaviour is as expected and since we want to reuse the names of variables, we clear everything and move to Section 2. (We could just skip this step since the variables would simply get replaced, but it is easier during working to just clear everything. There were many instances where we unknowingly used variables that we didn&rsquo;t replace and were puzzled at the plots no changing etc.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">del</span> option, stock_price, exercise_price, interest, variance, volatility, walk, time_range, time, expiration_date
</span></span></code></pre></div><h3 id="section-2">Section 2</h3>
<h4 id="application-using-real-world-data">Application using real-world data</h4>
<p>Having checked that the idea works, we begin by opening the .xlsx file we wish to use and defining our parameters before initializing our class.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;ZNGA.xlsx&#39;</span>, usecols<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Date&#39;</span>, <span style="color:#e6db74">&#39;High (in $)&#39;</span>, <span style="color:#e6db74">&#39;Low (in $)&#39;</span>, <span style="color:#e6db74">&#39;Close/Last&#39;</span>, <span style="color:#e6db74">&#39;Difference of High and Low&#39;</span>])
</span></span><span style="display:flex;"><span>high <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;High (in $)&#39;</span>]<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>low <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Low (in $)&#39;</span>]<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>close <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Close/Last&#39;</span>]<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>date <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>Date<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>interest <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0.005</span>,<span style="color:#ae81ff">0.01</span>, len(close))
</span></span><span style="display:flex;"><span>volatility <span style="color:#f92672">=</span> (np<span style="color:#f92672">.</span>average(high <span style="color:#f92672">-</span> low, weights <span style="color:#f92672">=</span> close))
</span></span><span style="display:flex;"><span>expiration_date <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
</span></span></code></pre></div><p>Because we want to check what happens for an exercise price both higher and lower than the original stock price (say ±10%), we create a vector containing those two values and we initialize both instances with a simple forloop</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>exercise_price <span style="color:#f92672">=</span> [close<span style="color:#f92672">-</span>(<span style="color:#ae81ff">0.1</span><span style="color:#f92672">*</span>close), close<span style="color:#f92672">+</span>(<span style="color:#ae81ff">0.1</span><span style="color:#f92672">*</span>close)]
</span></span><span style="display:flex;"><span>option <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> change <span style="color:#f92672">in</span> exercise_price:
</span></span><span style="display:flex;"><span>    option<span style="color:#f92672">.</span>append(Model(close, change, interest, expiration_date, volatility))
</span></span></code></pre></div><p>Now we call the call() and put() functions for each of the instances to generate the data, which we have plotted below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> model <span style="color:#f92672">in</span> option:
</span></span><span style="display:flex;"><span>    model<span style="color:#f92672">.</span>call()
</span></span><span style="display:flex;"><span>    model<span style="color:#f92672">.</span>put()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(date, close)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(date, model<span style="color:#f92672">.</span>callval)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(date, model<span style="color:#f92672">.</span>putval)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#39;Stock Price&#39;</span>, <span style="color:#e6db74">&#39; Call Price&#39;</span>, <span style="color:#e6db74">&#39;Put Price&#39;</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;price&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> model<span style="color:#f92672">.</span>ex_p[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;</span> model<span style="color:#f92672">.</span>stock_p[<span style="color:#ae81ff">0</span>]:
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Behaviour with a lower exercise price than stock price&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;lower.png&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Behaviour with higher exercise price than stock price&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;higher.png&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Finally, we use pandas to export all of the information we have gathered and created into an excel file. The model genrates the data frame of values of change in option prices which can be converted into an xlsx file which can then be
passed onto/be communicated to a non python user for further interpretation and decision making.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> np<span style="color:#f92672">.</span>arange(len(exercise_price)):
</span></span><span style="display:flex;"><span>        dict <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Date&#39;</span>: date,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Stock Price&#39;</span>: option[i]<span style="color:#f92672">.</span>stock_p,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Exercise Price&#39;</span>: option[i]<span style="color:#f92672">.</span>ex_p,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Interest&#39;</span>: option[i]<span style="color:#f92672">.</span>int_rate,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Time to Expiration&#39;</span>: option[i]<span style="color:#f92672">.</span>time_to_exp,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Volatility&#39;</span>: option[i]<span style="color:#f92672">.</span>vol,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Call Price&#39;</span>: option[i]<span style="color:#f92672">.</span>callval,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Put Price&#39;</span>: option[i]<span style="color:#f92672">.</span>putval}
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">.</span>append(pd<span style="color:#f92672">.</span>DataFrame(dict, index <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> pd<span style="color:#f92672">.</span>ExcelWriter(<span style="color:#e6db74">&#39;assignment.xlsx&#39;</span>) <span style="color:#66d9ef">as</span> writer:  
</span></span><span style="display:flex;"><span>    data[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>to_excel(writer, sheet_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sheet 1&#39;</span>, header <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>, index <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    data[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>to_excel(writer, sheet_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sheet 2&#39;</span>, header <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>, index <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>time_range <span style="color:#f92672">=</span> <span style="color:#ae81ff">1460</span> <span style="color:#75715e">#in days</span>
</span></span><span style="display:flex;"><span>walk <span style="color:#f92672">=</span> brownian(time_range)
</span></span><span style="display:flex;"><span>time <span style="color:#f92672">=</span> walk[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>stock_price <span style="color:#f92672">=</span> walk[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>abs(min(walk[<span style="color:#ae81ff">1</span>])) <span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(time, stock_price)
</span></span></code></pre></div><p>Next, we define the exercise price, where here we choose a &ldquo;smooth&rdquo; deviation from the original stock price, essentially taking a stable function and adding noise, defined by a uniform distribution over an arbitrary, probably non-realistic range. Likewise, the interest rate should float between 0% and 1%, and finally the range of the time to expiration was made 1, 2, 3, 4, and 5 months.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>variance<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0.005</span>, <span style="color:#ae81ff">0.01</span>)
</span></span><span style="display:flex;"><span>exercise_price <span style="color:#f92672">=</span> stock_price <span style="color:#f92672">+</span> <span style="color:#ae81ff">0.1</span><span style="color:#f92672">*</span>stock_price
</span></span><span style="display:flex;"><span>interest <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0.005</span>,<span style="color:#ae81ff">0.01</span>, time_range)
</span></span><span style="display:flex;"><span>expiration_date <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e">#days</span>
</span></span><span style="display:flex;"><span>volatility <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.23</span>
</span></span></code></pre></div><p>Finally, we can initialize the Model class, using the above as inputs and executing the call and put functions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>option <span style="color:#f92672">=</span> Model(stock_price, exercise_price, interest, expiration_date, volatility)
</span></span><span style="display:flex;"><span>option<span style="color:#f92672">.</span>call()
</span></span><span style="display:flex;"><span>option<span style="color:#f92672">.</span>put()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(stock_price)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(option<span style="color:#f92672">.</span>callval)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(option<span style="color:#f92672">.</span>putval)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#39;Stock Price&#39;</span>, <span style="color:#e6db74">&#39; Call Price&#39;</span>, <span style="color:#e6db74">&#39;Put Price&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;example.png&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Since we see that the behaviour is as expected and since we want to reuse the names of variables, we clear everything and move to Section 2. (We could just skip this step since the variables would simply get replaced, but it is easier during working to just clear everything. There were many instances where we unknowingly used variables that we didn&rsquo;t replace and were puzzled at the plots no changing etc.)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">del</span> option, stock_price, exercise_price, interest, variance, volatility, walk, time_range, time, expiration_date
</span></span></code></pre></div><h3 id="section-2-1">Section 2</h3>
<h4 id="application-using-real-world-data-1">Application using real-world data</h4>
<p>Having checked that the idea works, we begin by opening the .xlsx file we wish to use and defining our parameters before initializing our class.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_excel(<span style="color:#e6db74">&#39;ZNGA.xlsx&#39;</span>, usecols<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Date&#39;</span>, <span style="color:#e6db74">&#39;High (in $)&#39;</span>, <span style="color:#e6db74">&#39;Low (in $)&#39;</span>, <span style="color:#e6db74">&#39;Close/Last&#39;</span>, <span style="color:#e6db74">&#39;Difference of High and Low&#39;</span>])
</span></span><span style="display:flex;"><span>high <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;High (in $)&#39;</span>]<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>low <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Low (in $)&#39;</span>]<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>close <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Close/Last&#39;</span>]<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>date <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>Date<span style="color:#f92672">.</span>array
</span></span><span style="display:flex;"><span>interest <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>uniform(<span style="color:#ae81ff">0.005</span>,<span style="color:#ae81ff">0.01</span>, len(close))
</span></span><span style="display:flex;"><span>volatility <span style="color:#f92672">=</span> (np<span style="color:#f92672">.</span>average(high <span style="color:#f92672">-</span> low, weights <span style="color:#f92672">=</span> close))
</span></span><span style="display:flex;"><span>expiration_date <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
</span></span></code></pre></div><p>Because we want to check what happens for an exercise price both higher and lower than the original stock price (say ±10%), we create a vector containing those two values and we initialize both instances with a simple forloop</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>exercise_price <span style="color:#f92672">=</span> [close<span style="color:#f92672">-</span>(<span style="color:#ae81ff">0.1</span><span style="color:#f92672">*</span>close), close<span style="color:#f92672">+</span>(<span style="color:#ae81ff">0.1</span><span style="color:#f92672">*</span>close)]
</span></span><span style="display:flex;"><span>option <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> change <span style="color:#f92672">in</span> exercise_price:
</span></span><span style="display:flex;"><span>    option<span style="color:#f92672">.</span>append(Model(close, change, interest, expiration_date, volatility))
</span></span></code></pre></div><p>Now we call the call() and put() functions for each of the instances to generate the data, which we have plotted below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> model <span style="color:#f92672">in</span> option:
</span></span><span style="display:flex;"><span>    model<span style="color:#f92672">.</span>call()
</span></span><span style="display:flex;"><span>    model<span style="color:#f92672">.</span>put()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(date, close)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(date, model<span style="color:#f92672">.</span>callval)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(date, model<span style="color:#f92672">.</span>putval)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#39;Stock Price&#39;</span>, <span style="color:#e6db74">&#39; Call Price&#39;</span>, <span style="color:#e6db74">&#39;Put Price&#39;</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;time&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;price&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> model<span style="color:#f92672">.</span>ex_p[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;</span> model<span style="color:#f92672">.</span>stock_p[<span style="color:#ae81ff">0</span>]:
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Behaviour with a lower exercise price than stock price&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;lower.png&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Behaviour with higher exercise price than stock price&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>savefig(<span style="color:#e6db74">&#39;higher.png&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>Finally, we use pandas to export all of the information we have gathered and created into an excel file. The model genrates the data frame of values of change in option prices which can be converted into an xlsx file which can then be
passed onto/be communicated to a non python user for further interpretation and decision making.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> np<span style="color:#f92672">.</span>arange(len(exercise_price)):
</span></span><span style="display:flex;"><span>        dict <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Date&#39;</span>: date,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Stock Price&#39;</span>: option[i]<span style="color:#f92672">.</span>stock_p,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Exercise Price&#39;</span>: option[i]<span style="color:#f92672">.</span>ex_p,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Interest&#39;</span>: option[i]<span style="color:#f92672">.</span>int_rate,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Time to Expiration&#39;</span>: option[i]<span style="color:#f92672">.</span>time_to_exp,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Volatility&#39;</span>: option[i]<span style="color:#f92672">.</span>vol,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Call Price&#39;</span>: option[i]<span style="color:#f92672">.</span>callval,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;Put Price&#39;</span>: option[i]<span style="color:#f92672">.</span>putval}
</span></span><span style="display:flex;"><span>        data<span style="color:#f92672">.</span>append(pd<span style="color:#f92672">.</span>DataFrame(dict, index <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> pd<span style="color:#f92672">.</span>ExcelWriter(<span style="color:#e6db74">&#39;assignment.xlsx&#39;</span>) <span style="color:#66d9ef">as</span> writer:  
</span></span><span style="display:flex;"><span>    data[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>to_excel(writer, sheet_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sheet 1&#39;</span>, header <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>, index <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    data[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>to_excel(writer, sheet_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Sheet 2&#39;</span>, header <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>, index <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>)
</span></span></code></pre></div>
        </p>
        
    </div>

    <div class="prev-next">
        
    </div>

    
    
    <svg id="btt-button" class="arrow-logo" xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 384 512" onclick="topFunction()" title="Go to top">
        
        <path d="M177 159.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 255.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 329.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1z"/>
    </svg>
    <script>
        let backToTopButton = document.getElementById("btt-button");

        window.onscroll = function() {
            scrollFunction()
        };

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                backToTopButton.style.display = "block";
            } else {
                backToTopButton.style.display = "none";
            }
        }

        function topFunction() {
            smoothScrollToTop();
        }

        function smoothScrollToTop() {
            const scrollToTop = () => {
                const c = document.documentElement.scrollTop || document.body.scrollTop;
                if (c > 0) {
                    window.requestAnimationFrame(scrollToTop);
                    window.scrollTo(0, c - c / 8);
                }
            };
            scrollToTop();
        }
    </script>
    
    
</div>



    

        </main><footer class="footer">
    
    

    
    <span>&copy; 2024 Vasilis Valatsos</span>
    
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
